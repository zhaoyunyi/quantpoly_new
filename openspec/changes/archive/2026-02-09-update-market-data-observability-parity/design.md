## Context

行情能力为策略、回测、交易、风控的公共依赖。监控摘要是前端展示系统状态与业务状态的核心 read-model。当前能力不足会造成上层模块重复拼装数据。

## Goals / Non-Goals

- Goals:
  - 补齐行情查询的批量与目录能力。
  - 建立监控摘要 REST + WS 协同模式。
  - 明确上游失败时的降级与错误码语义。
- Non-Goals:
  - 不在本变更中实现新闻/宏观数据扩展。
  - 不引入外部 APM 平台适配。

## Decisions

- Decision: 行情查询统一通过 provider 抽象，支持缓存与限流。
- Decision: 监控摘要从业务上下文聚合只读数据，不直接暴露内部存储结构。
- Decision: WS 推送与 REST 摘要采用统一字段语义（type/payload/timestamp）。

## Risks / Trade-offs

- 风险：批量报价接口可能触发上游速率限制。
  - 缓解：批次切片 + 缓存 + 可识别限流错误码。
- 风险：摘要聚合增加接口延迟。
  - 缓解：采用预聚合缓存并提供时间戳。

## Migration Plan

1. 补齐市场目录、批量报价、最新行情接口。
2. 定义 provider 异常映射与降级策略。
3. 增加监控摘要接口并接入 WS 频道过滤。
4. 完成回归测试与 OpenSpec 严格校验。

## Open Questions

- 批量报价上限默认值是多少（50/100/200）？
- 监控摘要是否需要区分“系统健康”与“业务健康”两个层级？
